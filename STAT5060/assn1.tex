% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={assn1},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}

\title{assn1}
\author{}
\date{\vspace{-2.5em}2023-10-24}

\begin{document}
\maketitle

\hypertarget{question1}{%
\section{Question1}\label{question1}}

\hypertarget{a}{%
\subsection{(a)}\label{a}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{42}\NormalTok{)  }\CommentTok{\# Set a seed for reproducibility}

\CommentTok{\# Function to generate data}
\NormalTok{generate\_data }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(n, beta, mu, sigma) \{}
  \CommentTok{\# Generate predictor variable xi1}
\NormalTok{  xi1 }\OtherTok{\textless{}{-}} \FunctionTok{runif}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
  
  \CommentTok{\# Generate predictor variables xi2 and xi3 from a bivariate normal distribution}
\NormalTok{  xi23 }\OtherTok{\textless{}{-}}\NormalTok{ MASS}\SpecialCharTok{::}\FunctionTok{mvrnorm}\NormalTok{(n, mu, sigma)}
\NormalTok{  xi2 }\OtherTok{\textless{}{-}}\NormalTok{ xi23[, }\DecValTok{1}\NormalTok{]}
\NormalTok{  xi3 }\OtherTok{\textless{}{-}}\NormalTok{ xi23[, }\DecValTok{2}\NormalTok{]}
  
  \CommentTok{\# Calculate the mean mu\_i for each observation}
\NormalTok{  mu\_i }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(beta[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{2}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ xi1 }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{3}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ xi2 }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{4}\NormalTok{] }\SpecialCharTok{*}\NormalTok{ xi3)}
  
  \CommentTok{\# Generate the response variable yi from a Poisson distribution}
\NormalTok{  yi }\OtherTok{\textless{}{-}}\NormalTok{ stats}\SpecialCharTok{::}\FunctionTok{rpois}\NormalTok{(n, mu\_i)}
  
  \CommentTok{\# Return the generated data as a data frame}
  \FunctionTok{data.frame}\NormalTok{(yi, xi1, xi2, xi3)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{b}{%
\subsection{(b)}\label{b}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Function to estimate beta}
\NormalTok{estimate\_beta }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(data) \{}
\NormalTok{  model }\OtherTok{\textless{}{-}}\NormalTok{ stats}\SpecialCharTok{::}\FunctionTok{glm}\NormalTok{(yi }\SpecialCharTok{\textasciitilde{}}\NormalTok{ xi1 }\SpecialCharTok{+}\NormalTok{ xi2 }\SpecialCharTok{+}\NormalTok{ xi3, }\AttributeTok{data =}\NormalTok{ data, }\AttributeTok{family =}\NormalTok{ stats}\SpecialCharTok{::}\NormalTok{poisson)}
  \FunctionTok{coef}\NormalTok{(model)}
\NormalTok{\}}

\CommentTok{\# Function to calculate bias and RMS}
\NormalTok{calculate\_bias\_rms }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(estimates, true\_beta) \{}
\NormalTok{  S }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(estimates)}
\NormalTok{  bias }\OtherTok{\textless{}{-}} \FunctionTok{colMeans}\NormalTok{(estimates) }\SpecialCharTok{{-}}\NormalTok{ true\_beta}
\NormalTok{  rms }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{colMeans}\NormalTok{((estimates }\SpecialCharTok{{-}}\NormalTok{ true\_beta)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
  \FunctionTok{list}\NormalTok{(}\AttributeTok{bias =}\NormalTok{ bias, }\AttributeTok{rms =}\NormalTok{ rms)}
\NormalTok{\}}

\CommentTok{\# Set the parameters}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{400}  \CommentTok{\# Sample size}
\NormalTok{beta\_true }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\FloatTok{0.5}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{mu }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{sigma }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\FloatTok{0.2}\NormalTok{, }\DecValTok{1}\NormalTok{), }\AttributeTok{nrow =} \DecValTok{2}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{2}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{c}{%
\subsection{(c)}\label{c}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Perform the simulation}
\NormalTok{num\_simulations }\OtherTok{\textless{}{-}} \DecValTok{10}
\NormalTok{estimates }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ num\_simulations, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{num\_simulations) \{}
  \CommentTok{\# Generate data}
\NormalTok{  data }\OtherTok{\textless{}{-}} \FunctionTok{generate\_data}\NormalTok{(n, beta\_true, mu, sigma)}
  
  \CommentTok{\# Estimate beta}
\NormalTok{  estimates[i, ] }\OtherTok{\textless{}{-}} \FunctionTok{estimate\_beta}\NormalTok{(data)}
\NormalTok{\}}

\CommentTok{\# Calculate bias and RMS}
\NormalTok{results }\OtherTok{\textless{}{-}} \FunctionTok{calculate\_bias\_rms}\NormalTok{(estimates, beta\_true)}

\CommentTok{\# Print the bias and RMS}
\FunctionTok{print}\NormalTok{(results}\SpecialCharTok{$}\NormalTok{bias)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] -0.0020670937  0.0001083163  0.0007310704  0.0012524343
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{print}\NormalTok{(results}\SpecialCharTok{$}\NormalTok{rms)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [1] 1.1139186 1.6399504 0.8980553 0.9375613
\end{verbatim}

\hypertarget{question2}{%
\section{Question2}\label{question2}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(nnet)}

\FunctionTok{set.seed}\NormalTok{(}\DecValTok{1}\NormalTok{)  }\CommentTok{\# Set seed for reproducibility}

\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{800}

\CommentTok{\# Generate predictors xi1 and xi2}
\NormalTok{xi1 }\OtherTok{\textless{}{-}} \FunctionTok{runif}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{xi2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}

\CommentTok{\# Calculate the probabilities πij}
\NormalTok{logit\_pi }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ n, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}
\NormalTok{pi }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ n, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}
\NormalTok{yi }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, n)}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n) \{}
\NormalTok{  x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, xi1[i], xi2[i])}
\NormalTok{  logit\_pi[i, }\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}
\NormalTok{  logit\_pi[i, }\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{  logit\_pi[i, }\DecValTok{3}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{  logit\_pi[i, }\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{0}
  
\NormalTok{  pi[i, ] }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(logit\_pi[i, ]) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(}\FunctionTok{exp}\NormalTok{(logit\_pi[i, ]))}
  
\NormalTok{  yi[i] }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{prob =}\NormalTok{ pi[i, ])}
\NormalTok{\}}

\CommentTok{\# Create a data frame with the generated data}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{y=}\NormalTok{yi, }\AttributeTok{x0=}\DecValTok{1}\NormalTok{, }\AttributeTok{x1=}\NormalTok{xi1, }\AttributeTok{x2=}\NormalTok{xi2)}
\end{Highlighting}
\end{Shaded}

\hypertarget{b-1}{%
\subsection{(b)}\label{b-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data}\SpecialCharTok{$}\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{relevel}\NormalTok{(}\FunctionTok{factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{y), }\AttributeTok{ref =} \DecValTok{4}\NormalTok{)}
\NormalTok{model2 }\OtherTok{=} \FunctionTok{multinom}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{+}\NormalTok{ x1 }\SpecialCharTok{+}\NormalTok{ x2, }\AttributeTok{data =}\NormalTok{ data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 827.247560
## final  value 817.873073 
## converged
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{coef}\NormalTok{(model2)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##   (Intercept)         x1         x2
## 1  -1.2145645  1.3595525 -1.1922101
## 2  -1.2635765 -0.7282109  1.1623954
## 3   0.7547062 -0.6060677  0.8151951
\end{verbatim}

\hypertarget{c-1}{%
\subsection{(c)}\label{c-1}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{beta\_est }\OtherTok{=} \FunctionTok{list}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)\{}
\NormalTok{  n }\OtherTok{\textless{}{-}} \DecValTok{800}
  \CommentTok{\# Generate predictors xi1 and xi2}
\NormalTok{  xi1 }\OtherTok{\textless{}{-}} \FunctionTok{runif}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{  xi2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n, }\DecValTok{0}\NormalTok{, }\DecValTok{1}\NormalTok{)}
  
  \CommentTok{\# Calculate the probabilities πij}
\NormalTok{  logit\_pi }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ n, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}
\NormalTok{  pi }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =}\NormalTok{ n, }\AttributeTok{ncol =} \DecValTok{4}\NormalTok{)}
\NormalTok{  yi }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\ConstantTok{NA}\NormalTok{, n)}
  
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n) \{}
\NormalTok{    x }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, xi1[i], xi2[i])}
\NormalTok{    logit\_pi[i, }\DecValTok{1}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{))}
\NormalTok{    logit\_pi[i, }\DecValTok{2}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{    logit\_pi[i, }\DecValTok{3}\NormalTok{] }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(x }\SpecialCharTok{*} \FunctionTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{))}
\NormalTok{    logit\_pi[i, }\DecValTok{4}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{0}
    
\NormalTok{    pi[i, ] }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(logit\_pi[i, ]) }\SpecialCharTok{/} \FunctionTok{sum}\NormalTok{(}\FunctionTok{exp}\NormalTok{(logit\_pi[i, ]))}
    
\NormalTok{    yi[i] }\OtherTok{\textless{}{-}} \FunctionTok{sample}\NormalTok{(}\DecValTok{1}\SpecialCharTok{:}\DecValTok{4}\NormalTok{, }\DecValTok{1}\NormalTok{, }\AttributeTok{prob =}\NormalTok{ pi[i, ])}
\NormalTok{  \}}
  
  \CommentTok{\# Create a data frame with the generated data}
\NormalTok{  data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{y=}\NormalTok{yi, }\AttributeTok{x0=}\DecValTok{1}\NormalTok{, }\AttributeTok{x1=}\NormalTok{xi1, }\AttributeTok{x2=}\NormalTok{xi2)}
  
\NormalTok{  data}\SpecialCharTok{$}\NormalTok{y }\OtherTok{\textless{}{-}} \FunctionTok{relevel}\NormalTok{(}\FunctionTok{factor}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{y), }\AttributeTok{ref =} \DecValTok{4}\NormalTok{)}
\NormalTok{  model2 }\OtherTok{=} \FunctionTok{multinom}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{+}\NormalTok{ x1 }\SpecialCharTok{+}\NormalTok{ x2, }\AttributeTok{data =}\NormalTok{ data)}
\NormalTok{  beta\_est[[k]] }\OtherTok{=} \FunctionTok{coef}\NormalTok{(model2)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 825.895526
## final  value 812.965374 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 817.749218
## final  value 812.859663 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 829.109978
## final  value 819.471023 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 829.904331
## final  value 814.785780 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 822.838011
## final  value 816.664332 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 829.280471
## final  value 822.354104 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 823.338310
## final  value 815.780898 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 814.897621
## final  value 803.288823 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 833.677539
## final  value 818.989087 
## converged
## # weights:  16 (9 variable)
## initial  value 1109.035489 
## iter  10 value 831.536721
## final  value 813.728237 
## converged
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{beta\_est\_flat }\OtherTok{=} \FunctionTok{matrix}\NormalTok{(}\ConstantTok{NA}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{10}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{9}\NormalTok{)}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{)\{}
\NormalTok{  beta\_est\_flat[i, ] }\OtherTok{=} \FunctionTok{c}\NormalTok{(beta\_est[[i]])}
\NormalTok{\}}

\NormalTok{true\_beta }\OtherTok{=} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{, }\SpecialCharTok{{-}}\DecValTok{1}\NormalTok{, }\DecValTok{1}\NormalTok{)}
\NormalTok{calculate\_bias\_rms }\OtherTok{\textless{}{-}} \ControlFlowTok{function}\NormalTok{(estimates, true\_beta) \{}
\NormalTok{  S }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(estimates)}
\NormalTok{  bias }\OtherTok{\textless{}{-}} \FunctionTok{colMeans}\NormalTok{(estimates) }\SpecialCharTok{{-}}\NormalTok{ true\_beta}
\NormalTok{  rms }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{colMeans}\NormalTok{((estimates }\SpecialCharTok{{-}}\NormalTok{ true\_beta)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}
  \FunctionTok{list}\NormalTok{(}\AttributeTok{bias =}\NormalTok{ bias, }\AttributeTok{rms =}\NormalTok{ rms)}
\NormalTok{\}}

\FunctionTok{calculate\_bias\_rms}\NormalTok{(beta\_est\_flat, true\_beta)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## $bias
## [1]  0.042933146 -1.998004001  2.017198984  1.931241607  0.002735037
## [6] -2.022886395 -2.024356348  1.876589599 -0.012582167
## 
## $rms
## [1] 1.290414 1.407206 1.591943 1.656073 1.217067 1.512652 1.445628 1.429440
## [9] 1.421418
\end{verbatim}

\hypertarget{question3}{%
\section{Question3}\label{question3}}

\hypertarget{a-1}{%
\subsection{(a)}\label{a-1}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{set.seed}\NormalTok{(}\DecValTok{123}\NormalTok{)  }\CommentTok{\# Set a seed for reproducibility}

\CommentTok{\# Set the parameters and variables}
\NormalTok{n }\OtherTok{\textless{}{-}} \DecValTok{800}  \CommentTok{\# Number of subjects}
\NormalTok{t }\OtherTok{\textless{}{-}} \DecValTok{4}    \CommentTok{\# Number of time points}
\NormalTok{beta }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.7}\NormalTok{, }\FloatTok{0.4}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{)  }\CommentTok{\# True values of regression coefficients}
\NormalTok{sigma }\OtherTok{\textless{}{-}} \DecValTok{1}  \CommentTok{\# True value of subject{-}specific random effect variance}

\CommentTok{\# Generate subject{-}specific random effects}
\NormalTok{u }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \FunctionTok{sqrt}\NormalTok{(sigma))}

\CommentTok{\# Generate covariates and outcomes}
\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}
\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n) \{}
  \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{t) \{}
    \CommentTok{\# Generate covariates}
\NormalTok{    xit1 }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{prob =} \FloatTok{0.7}\NormalTok{)}
\NormalTok{    xit2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}
    
    \CommentTok{\# Calculate the logit of the probability}
\NormalTok{    logit\_pi }\OtherTok{\textless{}{-}}\NormalTok{ beta[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{*}\NormalTok{xit1 }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{3}\NormalTok{]}\SpecialCharTok{*}\NormalTok{xit2 }\SpecialCharTok{+}\NormalTok{ u[i]}
    
    \CommentTok{\# Calculate the probability of success}
\NormalTok{    pi }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(logit\_pi) }\SpecialCharTok{/}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{+} \FunctionTok{exp}\NormalTok{(logit\_pi))}
    
    \CommentTok{\# Generate the binary outcome}
\NormalTok{    yit }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{prob =}\NormalTok{ pi)}
    
    \CommentTok{\# Add the data to the dataframe}
\NormalTok{    data }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(data, }\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{subject =}\NormalTok{ i, }\AttributeTok{time =}\NormalTok{ t, }\AttributeTok{y =}\NormalTok{ yit, }\AttributeTok{x1 =}\NormalTok{ xit1, }\AttributeTok{x2 =}\NormalTok{ xit2))}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lme4)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: Matrix
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{generate\_q3\_data }\OtherTok{=} \ControlFlowTok{function}\NormalTok{()\{}
  \CommentTok{\# Set the parameters and variables}
\NormalTok{  n }\OtherTok{\textless{}{-}} \DecValTok{800}  \CommentTok{\# Number of subjects}
\NormalTok{  t }\OtherTok{\textless{}{-}} \DecValTok{4}    \CommentTok{\# Number of time points}
\NormalTok{  beta }\OtherTok{\textless{}{-}} \FunctionTok{c}\NormalTok{(}\SpecialCharTok{{-}}\FloatTok{0.7}\NormalTok{, }\FloatTok{0.4}\NormalTok{, }\SpecialCharTok{{-}}\FloatTok{0.5}\NormalTok{)  }\CommentTok{\# True values of regression coefficients}
\NormalTok{  sigma }\OtherTok{\textless{}{-}} \DecValTok{1}  \CommentTok{\# True value of subject{-}specific random effect variance}
  
  \CommentTok{\# Generate subject{-}specific random effects}
\NormalTok{  u }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(n, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \FunctionTok{sqrt}\NormalTok{(sigma))}
  
  \CommentTok{\# Generate covariates and outcomes}
\NormalTok{  data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n) \{}
    \ControlFlowTok{for}\NormalTok{ (t }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{t) \{}
      \CommentTok{\# Generate covariates}
\NormalTok{      xit1 }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{prob =} \FloatTok{0.7}\NormalTok{)}
\NormalTok{      xit2 }\OtherTok{\textless{}{-}} \FunctionTok{rnorm}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{mean =} \DecValTok{0}\NormalTok{, }\AttributeTok{sd =} \DecValTok{1}\NormalTok{)}
      
      \CommentTok{\# Calculate the logit of the probability}
\NormalTok{      logit\_pi }\OtherTok{\textless{}{-}}\NormalTok{ beta[}\DecValTok{1}\NormalTok{] }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{2}\NormalTok{]}\SpecialCharTok{*}\NormalTok{xit1 }\SpecialCharTok{+}\NormalTok{ beta[}\DecValTok{3}\NormalTok{]}\SpecialCharTok{*}\NormalTok{xit2 }\SpecialCharTok{+}\NormalTok{ u[i]}
      
      \CommentTok{\# Calculate the probability of success}
\NormalTok{      pi }\OtherTok{\textless{}{-}} \FunctionTok{exp}\NormalTok{(logit\_pi) }\SpecialCharTok{/}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{+} \FunctionTok{exp}\NormalTok{(logit\_pi))}
      
      \CommentTok{\# Generate the binary outcome}
\NormalTok{      yit }\OtherTok{\textless{}{-}} \FunctionTok{rbinom}\NormalTok{(}\DecValTok{1}\NormalTok{, }\AttributeTok{size =} \DecValTok{1}\NormalTok{, }\AttributeTok{prob =}\NormalTok{ pi)}
      
      \CommentTok{\# Add the data to the dataframe}
\NormalTok{      data }\OtherTok{\textless{}{-}} \FunctionTok{rbind}\NormalTok{(data, }\FunctionTok{data.frame}\NormalTok{(}\AttributeTok{subject =}\NormalTok{ i, }\AttributeTok{time =}\NormalTok{ t, }\AttributeTok{y =}\NormalTok{ yit, }\AttributeTok{x1 =}\NormalTok{ xit1, }\AttributeTok{x2 =}\NormalTok{ xit2))}
\NormalTok{    \}}
\NormalTok{  \}}
      \FunctionTok{return}\NormalTok{(data)}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\hypertarget{b-2}{%
\subsection{(b)}\label{b-2}}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{estimate\_q3\_beta }\OtherTok{=} \ControlFlowTok{function}\NormalTok{(data)\{}
\NormalTok{  model3 }\OtherTok{\textless{}{-}} \FunctionTok{glmer}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}} \DecValTok{1} \SpecialCharTok{+}\NormalTok{ x1 }\SpecialCharTok{+}\NormalTok{ x2 }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{|}\NormalTok{ subject), }\AttributeTok{data =}\NormalTok{ data, }\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{())}
  \FunctionTok{return}\NormalTok{(model3)}
\NormalTok{\}}
\NormalTok{data }\OtherTok{=} \FunctionTok{generate\_q3\_data}\NormalTok{()}
\NormalTok{model3 }\OtherTok{=} \FunctionTok{estimate\_q3\_beta}\NormalTok{(data)}
\NormalTok{beta\_est }\OtherTok{=} \FunctionTok{fixef}\NormalTok{(model3)}
\end{Highlighting}
\end{Shaded}

\hypertarget{c-2}{%
\subsection{(c)}\label{c-2}}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Initialize matrices to store parameter estimates}
\NormalTok{beta\_estimates }\OtherTok{\textless{}{-}} \FunctionTok{matrix}\NormalTok{(}\DecValTok{0}\NormalTok{, }\AttributeTok{nrow =} \DecValTok{10}\NormalTok{, }\AttributeTok{ncol =} \DecValTok{3}\NormalTok{)}
\NormalTok{sigma\_estimates }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{, }\DecValTok{10}\NormalTok{)}

\CommentTok{\# Repeat for 10 times}
\ControlFlowTok{for}\NormalTok{ (k }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\DecValTok{10}\NormalTok{) \{}
  \CommentTok{\# Fit the model and estimate beta}
\NormalTok{  data }\OtherTok{\textless{}{-}} \FunctionTok{generate\_q3\_data}\NormalTok{()}
\NormalTok{  model3 }\OtherTok{\textless{}{-}} \FunctionTok{estimate\_q3\_beta}\NormalTok{(data)}
\NormalTok{  beta\_estimates[k, ] }\OtherTok{\textless{}{-}} \FunctionTok{fixef}\NormalTok{(model3)}
  
  \CommentTok{\# Estimate sigma\^{}2}
\NormalTok{  sigma\_estimates[k] }\OtherTok{\textless{}{-}}  \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{as.numeric}\NormalTok{(}\FunctionTok{VarCorr}\NormalTok{(model3)}\SpecialCharTok{$}\NormalTok{subject[}\DecValTok{1}\NormalTok{]))}
\NormalTok{\}}

\CommentTok{\# Calculate bias and RMSE for beta estimates}
\NormalTok{beta\_bias }\OtherTok{\textless{}{-}} \FunctionTok{colMeans}\NormalTok{(beta\_estimates) }\SpecialCharTok{{-}}\NormalTok{ beta}
\NormalTok{beta\_rmse }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{colMeans}\NormalTok{((beta\_estimates }\SpecialCharTok{{-}}\NormalTok{ beta)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}

\CommentTok{\# Calculate bias and RMSE for sigma\^{}2 estimates}
\NormalTok{sigma\_bias }\OtherTok{\textless{}{-}} \FunctionTok{mean}\NormalTok{(sigma\_estimates) }\SpecialCharTok{{-}}\NormalTok{ sigma}
\NormalTok{sigma\_rmse }\OtherTok{\textless{}{-}} \FunctionTok{sqrt}\NormalTok{(}\FunctionTok{mean}\NormalTok{((sigma\_estimates }\SpecialCharTok{{-}}\NormalTok{ sigma)}\SpecialCharTok{\^{}}\DecValTok{2}\NormalTok{))}

\CommentTok{\# Print bias and RMSE for beta estimates}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Bias (beta):"}\NormalTok{, beta\_bias, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Bias (beta): 0.01804848 0.01902156 -0.00314478
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"RMSE (beta):"}\NormalTok{, beta\_rmse, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## RMSE (beta): 0.592414 0.7951595 0.5192099
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Print bias and RMSE for sigma\^{}2 estimate}
\FunctionTok{cat}\NormalTok{(}\StringTok{"Bias (sigma\^{}2):"}\NormalTok{, sigma\_bias, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Bias (sigma^2): -0.1132533
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cat}\NormalTok{(}\StringTok{"RMSE (sigma\^{}2):"}\NormalTok{, sigma\_rmse, }\StringTok{"}\SpecialCharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## RMSE (sigma^2): 0.1307237
\end{verbatim}

\hypertarget{question4}{%
\section{Question4}\label{question4}}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(CatDataAnalysis)}
\FunctionTok{library}\NormalTok{(ordinal)}
\FunctionTok{library}\NormalTok{(brms)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Loading required package: Rcpp
\end{verbatim}

\begin{verbatim}
## Loading 'brms' package (version 2.20.4). Useful instructions
## can be found by typing help('brms'). A more detailed introduction
## to the package is available through vignette('brms_overview').
\end{verbatim}

\begin{verbatim}
## 
## Attaching package: 'brms'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:lme4':
## 
##     ngrps
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:stats':
## 
##     ar
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{data}\NormalTok{(table\_12}\FloatTok{.3}\NormalTok{)}
\NormalTok{data }\OtherTok{=}\NormalTok{ table\_12}\FloatTok{.3}

\CommentTok{\# With the random intercept}
\NormalTok{model4 }\OtherTok{=} \FunctionTok{brm}\NormalTok{(outcome }\SpecialCharTok{\textasciitilde{}}\NormalTok{ occasion }\SpecialCharTok{+}\NormalTok{ treat }\SpecialCharTok{+} \FunctionTok{I}\NormalTok{(occasion }\SpecialCharTok{*}\NormalTok{ treat) }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1}\SpecialCharTok{|}\NormalTok{case), }\AttributeTok{family=}\FunctionTok{brmsfamily}\NormalTok{(}\StringTok{"cumulative"}\NormalTok{, }\StringTok{"logit"}\NormalTok{), }\AttributeTok{core=}\DecValTok{4}\NormalTok{, }\AttributeTok{data =}\NormalTok{ data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Compiling Stan program...
\end{verbatim}

\begin{verbatim}
## Start sampling
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{beta\_est }\OtherTok{=} \FunctionTok{rbind}\NormalTok{(}\FunctionTok{summary}\NormalTok{(model4)}\SpecialCharTok{$}\NormalTok{random}\SpecialCharTok{$}\NormalTok{case, }\FunctionTok{summary}\NormalTok{(model4)}\SpecialCharTok{$}\NormalTok{fixed)}
\NormalTok{beta\_est}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                     Estimate Est.Error    l-95% CI   u-95% CI     Rhat
## sd(Intercept)     1.95484084 0.2423802  1.49393736  2.4550645 1.001170
## Intercept[1]     -3.53347552 0.3721929 -4.30327034 -2.8415482 1.000781
## Intercept[2]     -1.50496385 0.3098854 -2.13374261 -0.9276325 1.001600
## Intercept[3]      0.56661690 0.2881080  0.01700935  1.1505529 1.002121
## occasion         -1.62599245 0.2895735 -2.20369003 -1.0756268 1.001147
## treat            -0.06822011 0.3879510 -0.84964753  0.7188487 1.001286
## IoccasionMUtreat -1.09111181 0.3879541 -1.86812492 -0.3508210 1.000061
##                   Bulk_ESS Tail_ESS
## sd(Intercept)     889.0269 1648.580
## Intercept[1]     1397.3704 1965.674
## Intercept[2]     1812.7316 2417.442
## Intercept[3]     2046.1149 2491.655
## occasion         2373.7426 2387.108
## treat            1627.4801 2288.888
## IoccasionMUtreat 3261.0646 2761.650
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{\# Without the random intercept}
\NormalTok{model4alt }\OtherTok{=} \FunctionTok{brm}\NormalTok{(outcome }\SpecialCharTok{\textasciitilde{}}\NormalTok{ occasion }\SpecialCharTok{+}\NormalTok{ treat }\SpecialCharTok{+} \FunctionTok{I}\NormalTok{(occasion }\SpecialCharTok{*}\NormalTok{ treat), }\AttributeTok{family=}\FunctionTok{brmsfamily}\NormalTok{(}\StringTok{"cumulative"}\NormalTok{, }\StringTok{"logit"}\NormalTok{), }\AttributeTok{core=}\DecValTok{4}\NormalTok{, }\AttributeTok{data =}\NormalTok{ data)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Compiling Stan program...
\end{verbatim}

\begin{verbatim}
## Start sampling
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{beta\_est\_alt }\OtherTok{=} \FunctionTok{summary}\NormalTok{(model4alt)}\SpecialCharTok{$}\NormalTok{fixed}
\NormalTok{beta\_est\_alt}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                     Estimate Est.Error    l-95% CI    u-95% CI     Rhat
## Intercept[1]     -2.26720366 0.2042834 -2.65864443 -1.85566736 1.000863
## Intercept[2]     -0.94813172 0.1811324 -1.29747882 -0.59032197 1.000886
## Intercept[3]      0.35970404 0.1722758  0.01790226  0.69477026 1.000798
## occasion         -1.03554812 0.2408792 -1.50793736 -0.55662567 1.000798
## treat            -0.02800509 0.2371464 -0.48823296  0.44077042 1.001076
## IoccasionMUtreat -0.71887303 0.3266222 -1.34313412 -0.09023257 1.002597
##                  Bulk_ESS Tail_ESS
## Intercept[1]     2464.589 2842.995
## Intercept[2]     2847.034 3086.424
## Intercept[3]     2909.642 3279.900
## occasion         2349.893 2833.921
## treat            2382.027 2651.719
## IoccasionMUtreat 2170.367 2708.226
\end{verbatim}

The interaction coefficient \(\beta_3=-1.10\) of the model with random
intercept shows a stronger evidence of interaction than the model
without random intercept, in which the interaction coefficient
\(\beta_3=-0.71\). In addition, the absolute values of other coeffcients
become larger after introducing the random intercept term \(u_i\).

\end{document}
